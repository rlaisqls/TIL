# ğŸ¤” ë™ì  ì¿¼ë¦¬

Querydslì—ì„œ ë™ì ì¸ ì¿¼ë¦¬ë¥¼ ìƒì„±í•´ë³´ì.

ë™ì ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ëŠ” ë°©ë²•ì€
```
1. BooleanBuilderë¥¼ ì‘ì„±í•˜ëŠ” ë°©ë²•
2. Where ì ˆê³¼ Predicateë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•
3. Where ì ˆê³¼ í”¼ë¼ë¯¸í„°ë¡œ Predicate ë¥¼ ìƒì†í•œ BooleanExpressionì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
```
ì´ ì„¸ê°€ì§€ê°€ ìˆë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì„¸ê°€ì§€ ë°©ë²•ì„ ëª¨ë‘ ë¹„êµí•´ë³´ì.

ëª¨ë“  ì½”ë“œì—ì„œ MemberSearchConditionë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ username, teamName, ageGoe, ageLoeë¥¼ ì¡°ê±´ìœ¼ë¡œ ê±¸ì–´ ì¡°íšŒí•˜ê³ , ê°’ì´ nullì¸ê²½ìš° whereì ˆì— ì ìš©í•˜ì§€ ì•Šë„ë¡ í–ˆë‹¤.

```java
@Getter
@NoArgsConstructor
public class MemberSearchCondition {
    private String username;
    private String teamName;
    private Integer ageGoe;
    private Integer ageLoe;
}
```

## 1. BooleanBuilder

```java
public List<MemberTeamDto> searchByBuilder(MemberSearchCondition condition){
    BooleanBuilder builder = new BooleanBuilder();

    if (hasText(condition.getUsername())) {
        builder.and(member.username.eq(condition.getUsername()));
    }

    if(hasText(condition.getTeamName())){
        builder.and(team.name.eq(condition.getTeamName()));
    }

    if(condition.getAgeGoe() != null) {
        builder.and(member.age.goe(condition.getAgeGoe()));
    }

    if(condition.getAgeLoe() != null){
        builder.and(member.age.loe(condition.getAgeLoe()));
    }

    return queryFactory
            .select(new QMemberTeamDto(
                    member.id.as("memberId"),
                    member.username,
                    member.age,
                    team.id.as("teamId"),
                    team.name.as("teamName")
            ))
            .from(member)
            .leftJoin(member.team, team)
            .where(builder)
            .fetch();
}
```
ifë¬¸ìœ¼ë¡œ í•´ë‹¹ í•„ë“œì— ê°’ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•œ í›„ì— í•„ìš”í•œ ë¶€ë¶„ì„ BooleanBuilderì— ì¶”ê°€í•˜ì—¬ ì¡°íšŒí•˜ëŠ” ë°©ë²•ì´ë‹¤. ì‚¬ì‹¤ ì´ ë°©ë²•ë„ ì•„ë˜ì˜ ë°©ë²•ê³¼ ë˜‘ê°™ì´ BooleanExpressionì„ ì‚¬ìš©í•˜ê³  ìˆì§€ë§Œ, BooleanBuilderì— í•œë²ˆì— ëª¨ì€ë‹¤ìŒ ì¡°ê±´ì— ë„£ëŠ”ë‹¤ëŠ” ì ì´ ë‹¤ë¥´ë‹¤. Whereë¬¸ì˜ ì¡°ê±´ë“¤ì„ í•œëˆˆì— ë³´ê¸° ì–´ë µê³ , ì–´ë–¤ ì¿¼ë¦¬ê°€ ë‚˜ê°€ëŠ”ì§€ ì˜ˆì¸¡í•˜ê¸° í˜ë“¤ë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.

## 2. Where ì ˆê³¼ BooleanExpression

```java
public List<MemberTeamDto> searchByBooleanExpression(MemberSearchCondition condition){
    return queryFactory
            .select(new QMemberTeamDto(
                    member.id.as("memberId"),
                    member.username,
                    member.age,
                    team.id.as("teamId"),
                    team.name.as("teamName")
            ))
            .from(member)
            .leftJoin(member.team, team)
            .where(
                usernameEq(condition.getUsername()),
                teamNameEq(condition.getTeamName()),
                ageGoe(condition.getAgeGoe()),
                ageLoe(condition.getAgeLoe())
            )
            .fetch();
}

private BooleanExpression usernameEq(String username) {
    return hasText(username) ? member.username.eq(username) : null;
}

private BooleanExpression teamNameEq(String teamName) {
    return hasText(teamName) ? team.name.eq(teamName) : null;
}

private BooleanExpression ageGoe(Integer ageGoe) {
    return ageGoe != null ? member.age.goe(ageGoe) : null;
}

private BooleanExpression ageLoe(Integer ageLoe) {
    return ageLoe != null ? member.age.loe(ageLoe) : null;
}

private BooleanExpression ageBetween(Integer ageLoe, Integer ageGoe) {
    return ageLoe(ageLoe).and(ageGoe(ageGoe));
}
```
BooleanExpression ì€ and ì™€ or ê°™ì€ ë©”ì†Œë“œë“¤ì„ ì´ìš©í•´ì„œ BooleanExpression ì„ ì¡°í•©í•´ì„œ ìƒˆë¡œìš´ BooleanExpression ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì¬ì‚¬ìš©ì„±ì´ ë†’ê³ , nullì¼ê²½ìš° Where ì ˆì—ì„œ ìë™ìœ¼ë¡œ ë¬´ì‹œë˜ê¸° ë•Œë¬¸ì— ì•ˆì „í•˜ë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤. (í•˜ì§€ë§Œ ëª¨ë“  ì¡°ê±´ì´ nullì¼ ê²½ìš°ì—ëŠ” ì¥ì• ê°€ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜í•´ì•¼í•œë‹¤.)

ê·¸ë ‡ê¸° ë•Œë¬¸ì— ë™ì  ì¿¼ë¦¬ë¥¼ ì¨ì•¼í• ë•ŒëŠ” BooleanExpressionì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤ê³  í•œë‹¤.




ì¶œì²˜:<br>
[ìš°ì•„ì½˜2020] ìˆ˜ì‹­ì–µê±´ì—ì„œ QUERYDSL ì‚¬ìš©í•˜ê¸° https://www.youtube.com/watch?v=zMAX7g6rO_Y&t=656s
