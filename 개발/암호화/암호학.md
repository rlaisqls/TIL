암호학의 분류

- 대칭 암호학(또는 비밀 키 암호학): 비밀 하나가 사용된다. 여러 참가자가 비밀을 알고 있는 경우 공유된 비밀이라고 한다.
- 비대칭 암호학(또는 공개 키 암호학): 참가자들은 비밀에 비대칭적인 관점을 가지고 있다. 예를 들어 일부는 공개 키를 알고 있고, 일부는 공개 키와 비밀 키 모두를 알고 있다.

암호학을 나누는 또 다른 방법은 다음과 같다.

- 수학 기반 구성: 인수 분해와 같은 수학적 문제에 의존한다. (예: 디지털 서명 및 비대칭 암호화를 위한 RSA 알고리즘)
- 휴리스틱 기반 구성: 암호 분석가의 관찰 및 통계 분석에 의존한다. (예: 대칭 암호화를 위한 AES)

### 해시 함수

- 해시 함수는 데이터를 입력으로 받고 고유한 바이트 문자열을 생성한다. 출력을 다이제스트, 혹은 해시라고 한다.
- 해시의 특징 3가지가 있다.
  - 역상 저항성(Preimage resistance): 역상(Preimage == y) 추측에 저항하는(Resistance) 성질
    - 최초, 해시값(y)이 확인된 상태
    - 입력값(x)을 찾는 것은 계산적으로 불가능
  - 제2 역상 저항성(Second preimage resistance): 역상(Preimage == y) 추측에 저항하는(Resistance) 성질
    - 최초, 입력값(x)이 확인된 상태
    - 동일한 해시값(y)이 나오는 다른 입력값(x')을 찾는 것은 계산적으로 불가능
  - 충돌 저항성(Collision resistance): 서로 다른 입력값 추측에 저항하는(Resistance) 성질.
    - 서로 다른 입력값은 동일한 해시값을 생성(Collision)

- 아래와 같은 openssl 명령으로 파일의 해시를 얻을 수 있다.

   ```
   $ openssl dgst -sha256 tmp
   SHA2-256(tmp)= e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
   ```

- 해시 다이제스트의 크기 (생일 문제)
  - 한 방에 여러 사람이 있을 때, 최소 50%의 확률로 두 사람이 같은 생일을 가지려면, 단 23명만 무작위로 선출하면 된다.
  - 이처럼, 2^n가지 가능성이 있는 공간에서 문자열을 무작위로 생성할 때, 약 2^n/2의 문자열만 생성해보면 50% 확률로 충돌이 발생할 수 있다. (동일한 다이제스트가 나올 수 있다)
  - 그렇기에 해시에서도 이처럼 128비트의 보안으로 충돌을 피하려면 대략 256비트의 다이제스트를 생성해야한다.

- SHA-2
  - 여러 버전이 있다 (SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256)
  - 오늘날 SHA-256가 주로 사용된다.
  - SHA-2는 압축 함수를 반복적으로 호출하여 메시지를 해시하는 머클-담고르 구조이다.
  - 압축함수: 몇 개의 데이터를 받고 더 적은 데이터를 반환하는 함수
  - 동작 과정:
    1. 해시하려는 입력에 패딩을 적용한 다음 입력을 압축 함수에 맞는 블록으로 자른다.
    2. 압축 함수의 이전 출력을 압축 함수에 대한 두 번째 인수로 사용하여 압축 함수를 메시지 블록에 반복적으로 적용한다. 최종 출력이 다이제스트가 된다.
  - 길이 확장 공격(length extension attack)에 취약하다.
    - 공격자가 해시값 H(m)과 메시지 m의 길이를 알 때, m의 내용을 모르더라도 H(m || padding || m')을 계산할 수 있다.

- SHA-3
  - 여러 버전이 있다. (SHA-3-224, SHA-3-256, SHA-3-384, SHA-3-512)
  - SHA-3는 스펀지 구조(sponge construction)로 제작되었다. 입력을 받아 동일한 크기의 출력을 반환하는 Keccak-f라는 특정 순열을 기반으로 한다.
  - 동작 과정:
    1. 입력과 출력을 r(rate)부분과 c(capacity) 부분으로 임의로 나눈다.
       - 버전마다 다른 파라미터를 사용한다. c는 비밀로 취급해야하며 c가 클수록 스펀지 구조가 더 안전하다고 한다.
    2. 순열 입력의 r과 입력을 XOR한다.
    3. 마지막 상태의 r을 사용한다.
  - 길이 확장 공격에 면역이다.

- XOF (eXtendable-Output Function)
  - 가변 길이 출력을 생성할 수 있는 해시 함수
  - 기존 해시 함수는 고정 길이 출력만 생성하지만, XOF는 필요한 만큼의 출력을 생성할 수 있다.

- SHAKE
  - SHA-3 표준의 일부로 정의된 XOF
  - SHAKE128과 SHAKE256 두 가지 버전이 있다.
  - 원하는 길이의 출력을 생성할 수 있다.
  - cSHAKE (customizable SHAKE)
    - SHAKE의 확장 버전으로 사용자 정의가 가능하다.
    - 함수 이름과 custom 문자열을 입력으로 받아 도메인 분리를 제공한다.
