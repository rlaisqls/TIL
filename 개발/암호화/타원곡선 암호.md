타원곡선 암호(Elliptic Curve Cryptography, ECC)는 타원곡선의 이산 로그 문제를 기반으로 한 공개키 암호 시스템이다.

## 이산 대수 문제 (Discrete Logarithm Problem, DLP)

- 이산 대수 문제는 다음과 같이 정의된다:
  - 소수 p, 원시근(primitive root) g, 그리고 h가 주어졌을 때 gˣ ≡ h (mod p)를 만족하는 지수 x를 찾는 문제
- 일반적인 실수 체계(R)에서 logₐ h (mod p)가 된다는 점에서 이산 로그라는 이름이 붙었다.
- 여기서 "이산(discrete)"이라는 용어는 법 p = {x | 1 ≤ x < p, x ∈ Z}가 유한하고 불연속적인 정수 집합이기 때문이다. 군론에선 이를 유한체(finite field)라고 한다.

- g가 법 p에 관한 원시근이고 gcd(x, p) = 1일 때, 지수(index)로 다음과 같이 표현할 수 있다:

    ```
    gˣ ≡ h (mod p) ⇔ x = indₐ h    (1 ≤ x ≤ φ(p) = p-1)
    ```

  - φ는 오일러 파이 함수(Euler phi function)
  - p가 소수이므로 φ(p) = p-1
  - x는 1 이상 p-1 이하의 값을 가짐

**원시근과 기약잉여계**

원시근 g에 대하여 R = {g, g², ..., g^φ(p)}는 기약잉여계(reduced residue system)를 형성한다:

- 기약잉여계는 완전잉여계 중 법 p와 서로소인 원소들의 집합
- p가 소수이므로 φ(p) = p-1개의 원소를 가짐
- 각 원소는 1, 2, ..., p-1과 서로 겹치지 않고 합동

따라서 DLP에서 gˣ ≡ h (mod p)의 x를 구하는 것은 h와 합동인 유일한 원소 gˣ를 기약잉여계에서 찾는 것과 동일하다.

### 계산 복잡도

DLP가 어려운 이유는 대소 관계의 불규칙성 때문이다:

- 실수에서는 a > b이면 logₐ a > logₐ b가 성립
- 유한체에서는 이러한 대소 관계가 보장되지 않음
- gˣ mod p의 값은 x가 증가해도 불규칙하게 분포

**예시: 2ˣ (mod 13)**

| x | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 |
|---|---|---|---|---|---|---|---|---|---|-----|-----|-----|
| 2ˣ | 2 | 4 | 8 | 3 | 6 | 12 | 11 | 9 | 5 | 10 | 7 | 1 |

x가 증가해도 2ˣ mod 13의 값은 규칙 없이 분산되어 있다.

암호에서 사용하는 큰 소수 p (예: 2²⁰⁴⁸)의 경우:

- 탐색 공간: 약 10⁶¹⁹개의 정수
- 최선의 알고리즘(Pohlig-Hellman): O(√n) 시간 복잡도
- 2²⁰⁴⁸의 제곱근도 2¹⁰²⁴ > 10³⁰⁰으로 실질적으로 계산 불가능

이러한 계산적 어려움이 Diffie-Hellman, ElGamal 등의 암호 알고리즘의 안전성 기반이 된다.

## 타원곡선 이산 로그 문제 (ECDLP)

타원곡선 암호는 일반 DLP 대신 타원곡선 위의 점 연산을 사용한다:

- **일반 DLP**: gˣ ≡ h (mod p)에서 x 찾기
- **ECDLP**: Q = xP (타원곡선 위의 점)에서 x 찾기

### secp256k1

비트코인은 secp256k1 곡선을 사용한다.

- 공개키 암호를 위한 타원 곡선은 다음 매개변수로 정의된다.
  - 곡선 y² = x³ + ax + b에서의 a와 b
  - 유한체의 위수인 소수 p
  - 생성점 G의 x좌표 x, y
  - G로 생성한 군의 위수

- 이 중 비트코인은 secp2561 곡선을 사용한다. 해당 곡선의 매개변수는 다음과 같다.
  - a=0, b=7 (y² = x³+7)
  - p = 2^256 - 2^32 - 977
  - G = (0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798, 0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8)
  - n = 0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141

---
참고

- 밑부터 시작하는 비트코인 (Programming Bitcoin by Jimmy Song, O'Reilly)
- [Standards for Efficient Cryptography (SEC) - secp256k1](https://www.secg.org/sec2-v2.pdf)
- [타원곡선의 근본적인 수학 이야기](https://hyun-jeong.medium.com/타원곡선의-근본적인-수학-이야기-1-427948ca28c5)
- [타원곡선 암호의 이해 (한국정보보호학회)](https://koreascience.kr/article/CFKO200411922726381.pdf)
