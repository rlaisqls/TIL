# π”“ CSRF

CSRF(Cross site Request forgery)λ” μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ μ·¨μ•½μ  μ¤‘ ν•λ‚λ΅, μ΄μ©μκ°€ μλ„ν•μ§€ μ•μ€ μ”μ²­μ„ ν†µν• κ³µκ²©μ„ μλ―Έν•λ‹¤. μ¦‰, μΈν„°λ„· μ‚¬μ©μκ°€ μμ‹ μ μμ§€μ™€ λ¬΄κ΄€ν•κ² κ³µκ²©μκ°€ μλ„ν• νΉμ • ν–‰μ„λ¥Ό μ›Ήμ‚¬μ΄νΈμ μ”μ²­ν•λ„λ΅ ν•μ—¬ κ°„μ ‘μ μΌλ΅ ν•΄ν‚Ήν•λ„λ΅ ν•λ” κ²ƒμ΄λ‹¤.

<img src="https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcRMDFmY7IZJcsHpcFdGe_bb93zHmDjWvoLJ6wqilqYBg99Sc1mw">

λ”°λΌμ„, μ¤ν”„λ§ μ‹νλ¦¬ν‹°λ” CSRF κ³µκ²©μ„ λ°©μ§€ν•κΈ° μ„ν• κΈ°λ¥μ„ κ°€μ§€κ³ μλ‹¤.

@EnableWebSecurity μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ΄λ©΄ Referrer κ²€μ¦, CSRF Token μ‚¬μ© λ“±μ κΈ°λ¥μ΄ ν™μ„±ν™”λλ‹¤.

κ° κΈ°λ¥μ— λ€ν•΄ κ°„λ‹¨ν•κ² μ•μ•„λ³΄μ

- Referrer κ²€μ¦

μ„λ²„λ‹¨μ—μ„ requestμ referrerμ„ ν™•μΈν•μ—¬ domainμ΄ μΌμΉν•λ”μ§€ κ²€μ¦ν•λ” λ°©λ²•μ΄λ‹¤.

- Spring Security CSRF Token

μ„μμ ν† ν°μ„ λ°κΈ‰ν• ν›„ μμ›μ— λ€ν• λ³€κ²½ μ”μ²­μΌ κ²½μ° Token κ°’μ„ ν™•μΈν• ν›„ ν΄λΌμ΄μ–ΈνΈκ°€ μ •μƒμ μΈ μ”μ²­μ„ λ³΄λ‚Έκ²ƒμΈμ§€ ν™•μΈν•λ” λ°©λ²•μ΄λ‹¤. λ§μ•½ CSRF Tokenμ΄ μ΅΄μ¬ν•μ§€ μ•κ±°λ‚, κΈ°μ΅΄μ Tokenκ³Ό μΌμΉν•μ§€ μ•λ” κ²½μ° 4XX μƒνƒμ½”λ“λ¥Ό λ°ν™ν•λ„λ΅ ν•λ‹¤. 
(νƒ€μ„λ¦¬ν”„ ν…ν”λ¦Ώ λ° jspμ spring:form νƒκ·Έλ¥Ό μ‚¬μ©ν•λ‹¤λ©΄ κΈ°λ³Έμ μΌλ΅ csrf tokenμ„ λ„£μ–΄μ¤€λ‹¤)

### μ™ λΉ„ν™μ„±ν™”ν• κΉ?

CSRF(Cross-Site Request Forgery)λ” "μ‚¬μ΄νΈ κ°„ μ”μ²­"μ΄ λ°μƒν•κΈ° μ‰¬μ΄ μ›Ήμ— λ€ν•΄ μ”μ²­ν•  λ• ν•„μ”ν•λ‹¤.

μ΄λ¬ν• μ• ν”λ¦¬μΌ€μ΄μ…μ€ λ³΄ν†µ ν…ν”λ¦Ώ μ—”μ§„(Thymeleaf, JSP)λ“±μ„ μ‚¬μ©ν•μ—¬ μ„λ²„ μΈ΅μ—μ„ μ „μ²΄ HTMLμ„ μƒμ„±ν•λ” κµ¬μ΅°μ΄λ‹¤.

ν•μ§€λ§ μµμ‹ μ μ• ν”λ¦¬μΌ€μ΄μ…μ€ μ£Όλ΅ REST APIμ μ•¤λ“ν¬μΈνΈμ— μμ΅΄ν•λ©°, HTTP ν•μ‹μ— λ”°λΌ λ¬΄μƒνƒλ΅ ν†µμ‹ ν•λ„λ΅ ν•λ‹¤. μ΄λ¬ν• `REST API`λ” μ„λ²„μ½μ μ„Έμ…μ΄λ‚ λΈλΌμ°μ € μΏ ν‚¤μ— μμ΅΄ν•μ§€ μ•κΈ° λ•λ¬Έμ— CSRF κ³µκ²©μ λ€μƒμ΄ λ  μ μ—†λ‹¤.

λ”°λΌμ„ APIλ§ λ…Έμ¶ν•λ” `REST API`λ¥Ό λ§λ“λ” κ²½μ°μ—λ” CSRFλ¥Ό λΉ„ν™μ„±ν™”ν•΄λ„ λλ‹¤.