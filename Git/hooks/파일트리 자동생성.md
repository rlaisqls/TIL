# 🌳 파일트리 자동생성

어느날이었다... 이 TIL 레포지토리의 파일 트리를 `README.md` 파일에 링크가 달린 계층형 형식으로 넣고싶다는 생각이 들었다. 그렇게 하면 레포에 들어왔을때 다른 extension이 없는 사람도 레포의 내용을 한눈에 찾아보고, 어떤 내용들이 있는지 보기 쉬울 것 같았다.

가장 먼저 떠오른 방법은 `tree` 명령어였다. 

<img width="747" alt="Screenshot 2022-11-21 at 23 29 42" src="https://user-images.githubusercontent.com/81006587/203080444-3f5baa20-b080-41e5-8e82-cf4c38203cc7.png">

`tree` 명령어는 이런식으로 파일 트리를 나타낸다. 하지만 tree 명령어를 md로 변환하려면 특정 조건에 맞는 문자열을 바꿔서 원하는 모양으로 만들어주는 코드가 필요했다...

하지만 나는 shell script나 명령어에 대해 자세히 알지 못하기 때문에 구글에 서치를 하기 시작했다. 그러다 이런 글을 발견했다. 

<a href="https://blog.potados.com/dev/directory-listing-in-readme/">README.md에 프로젝트 트리 보여주기 feat. tree & gsed</a>

헉..! 그 내용을 친절히 한국어로 풀어 설명해주신 블로그 글이 있었다. (깃 파일트리 자동생성을 본인의 레포에도 적용해보고싶다면, 꼭 한번 읽어보시기 바랍니다.)

```bash
#!/bin/bash

#File: tree-md

tree=$(tree -tf --noreport -I '*~' --charset ascii $1 |
       sed -e 's/| \+/  /g' -e 's/[|`]-\+/ */g' -e 's:\(* \)\(\(.*/\)\([^/]\+\)\):\1[\4](\2):g')

printf "# Project tree\n\n${tree}"
```

이 스크립트를 실행하면

```bash
$ ./tree-md .
# Project tree

.
 * [tree-md](./tree-md)
 * [dir2](./dir2)
   * [file21.ext](./dir2/file21.ext)
   * [file22.ext](./dir2/file22.ext)
   * [file23.ext](./dir2/file23.ext)
 * [dir1](./dir1)
   * [file11.ext](./dir1/file11.ext)
   * [file12.ext](./dir1/file12.ext)
 * [file_in_root.ext](./file_in_root.ext)
 * [README.md](./README.md)
 * [dir3](./dir3)
```

md 파일에 위와 같은 결과를 출력해넣을 수 있으며, sed 호환등의 문제를 해결하고 상황에 맞게 이러저러한 것들을 수정해주면 커밋을 할때마다 `githook`으로 README.md에 파일트리를 넣을 수 있다는 것이었다!


## 주의

해당 블로그글과 필자가 `githook`을 적용한 환경은 모두 mac 환경이다. sed은 윈도우에도 지원되는 명령어지만 gsed는 윈도우에서 지원되지 않는다. sed는 gsed에 비해 세부 옵션이 많이 없고 레퍼런스도 적어서 윈도우에서 이것을 만들기는 약간 어려울 수 있다.