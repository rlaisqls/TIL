# 🌳 파일트리 자동생성 V3

큰 변화는 아니지만 작게 수정할 요소가 있어 새 버전의 소스코드를 만들었다.

## 1. 줄바꿈 처리

```bash
# 변경 전
...
gsed -e 's:\(━ \)\(\(.*/\)\([^/]\+\)\):\1[\4](\2):g' |
gsed -e 's/)/)<\/br>/g' |
...
```

이전에는 md에 줄바꿈을 적용하기 위해서 닫는 괄호인 `)` 문자 뒤에 `<br/>`을 출력하도록 했는데, 파일명에 `)`가 들어가는 경우 불필요한 줄바꿈이 들어가서 md link 형식으로 format을 바꿔주는 표현식과 합쳐줬다.

```bash
# 변경 후
...
gsed -e "s:\(━ \)\(\(.*/\)\([^/]\+\)\):\1[\4](\2)<\/br>:g" |
...
```

둘을 별도의 표현식으로 분리하려다가, sed의 capture group에 대해서도 같이 찾아보게 되었다.

- `sed 's/^\((.*\))$/(\1)</br>/'`
  
이런 식으로도 구현 가능하지만 합치는게 더 간결한 것 같다.

- https://linuxhint.com/sed-capture-group-examples/
- https://stackoverflow.com/questions/2777579/how-can-i-output-only-captured-groups-with-sed

## 2. 변수 처리

```bash
# 변경 전
filepath=/Users/rlaisqls/Documents/github/TIL

...
gsed -e 's=/Users/rlaisqls/Documents/github/TIL/=./=g' |
gsed -e 's=/Users/rlaisqls/Documents/github/TIL=./TIL</br>=g' |
...
```

gsed로 string replace 하는 부분에 filepath 변수가 적용되어있지 않아 수정해주었다.

```bash
# 변경 후
...
gsed -e "s=$filepath/=./=g" |
gsed -e "s=$filepath=./TIL</br>=g" |
...
```

처음에는 그냥 따옴표에 `$`로 변수를 설정했는데 안되어서, 구글링해보았더니 그 부분에서 따옴표와 쌍따옴표의 차이가 존재한다고 한다.

Single Quotes은 그냥 character를 그대로 인식하고, 쌍따옴표인 Double Quotes은 `$`, `\`, `!` 등의 표현을 사용할 수 있다.

```bash
$ echo "$(echo "upg")"
upg
$ echo '$(echo "upg")'
$(echo "upg")
```

gnu 공식 문서에도 이러한 내용이 설명되어있다.

> 3.1.2.2 Single Quotes<br><br>Enclosing characters in single quotes (') preserves the literal value of each character within the quotes. A single quote may not occur between single quotes, even when preceded by a backslash.<br><br>3.1.2.3 Double Quotes<br><br>Enclosing characters in double quotes (") preserves the literal value of all characters within the quotes, with the exception of $, `, \, and, when history expansion is enabled, !. The characters $ and ` retain their special meaning within double quotes (see Shell Expansions). The backslash retains its special meaning only when followed by one of the following characters: $, `, ", \, or newline. Within double quotes, backslashes that are followed by one of these characters are removed. Backslashes preceding characters without a special meaning are left unmodified. A double quote may be quoted within double quotes by preceding it with a backslash. If enabled, history expansion will be performed unless an ! appearing in double quotes is escaped using a backslash. The backslash preceding the ! is not removed.<br><br>The special parameters * and @ have special meaning when in double quotes (see Shell Parameter Expansion).

---

참고

- https://askubuntu.com/questions/76808/how-do-i-use-variables-in-a-sed-command
- https://www.gnu.org/software/bash/manual/html_node/Single-Quotes.html