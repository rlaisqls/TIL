# 매체 접근 제어(MAC, Media Access Control)

- 공유 링크를 사용할 떄 링크에 접근하는 것을 조율하기 위한 데이터링크 계층의 다중 접근 프로토콜
- 동시에 각 노드가 링크에 대한 접근을 확보했다는 것을 확정하고, 충돌을 방지한다
- 크게 임의접근 방식, 제어 접근 방식, 채널화 방식으로 총 세가지가 있다.

## 임의 접근 방식

다수 노드가 공유 매체에서 프레임을 전송하기 위해 스케줄링 및 전송 순서 없이 충돌 감지 및 회피, 충돌 발생 시 재전송 하는 방식이다. (일단 보내고 생각)

각 노드는 다른 노드의 간섭을 받지 않고 공유 매체에 접근할 권한을 보유한다.

- **ALOHA**

  <img width="315" alt="image" src="https://github.com/rlaisqls/TIL/assets/81006587/1886d09e-c573-40e5-92e3-6db1031db750">
      
      - 타 노드와 무관하게 프레임 전송, 충돌 허용
      - 프레임 충돌 시 전송 실패 프레임 재전송
      - 취약시간: 충돌이 발생할 수 있는 시간
      - pure ALOHA: 언제든지 전송
      - slotted ALOHA: 타임슬롯 시작시 전송
  
- **CSMA**
    - 먼저 사용중인지 아닌지 보고 전송
    - 지속방식: 채널이 사용중일 때 어떻게 해야할까?
        - 1 지속 방식: 사용 안하는거 감지하면 즉시 재전송
        - 비지속 방식: 사용 안하는거 감지하면 즉시 재전송 + 사용중이면 기다렸다가 다시 감지
        - p 지속 방식: 사용 안하는거 감지하면 p 확률로 재전송
    - **CSMA/CD**
    
  <img width="665" alt="image" src="https://github.com/rlaisqls/TIL/assets/81006587/f5d79e32-322e-42e4-b415-4d9abdf1db5d">

      - 프레임 전송 전 공유 매체 사용 여부 체크
      - 프레임 전송 후 충돌 발생 여부 체크
          - 전송이 끝나기 전에 감지해서 충돌 발생 사실을 더 빠르게 알릴 수 있음
      - 이더넷, LAN에서 많이 사용
      - ALOHA와 차이점
          - 지속과정
          - 프레임 전송(다 보내고 아는 것이 아님, 보내면서 충돌인지 계속 확인)
          - 충돌 신호

    - **CSMA/CA**
    
  <img width="252" alt="image" src="https://github.com/rlaisqls/TIL/assets/81006587/ef790878-785e-4bcb-a87f-5ffa743d47f5">

      - IEEE802.11 표준, 무선 LAN에서 사용 → 충돌 감지 어려워 검출이 아니라 회피해야함
      - 프레임 전송 전 공유 매체 사용 여부 체크
      - IFS 이후 매체가 idle 인 경우 프레임 전송
      - 매체가 사용중인 경우 Backoff time 대기

## 제어 접근 방식

- **폴링**
  - 지국 중 하나가 주국(primary station)이 되고 다른 지국들은 종국 (secondary station)이 되는 접속 형태에서 동작
  - 종국으로 가는 데이터도 모두 주국을 통해서 전달
  - 주국이 링크를 제어하며, 종국은 그 지시에 따름
  - 폴: NCK(난 몰름),  ACK(나 데이터 있음)
    - 주국이 종국으로부터 전송을 요청하는데 사용
  - 선택: SEL
    - 주국이 송신할 것이 있을 때 사용
    - 예정된 전송을 위해 주국은 종국의 준비 상태에 대한 확인 응답을 대기
    - 주국은 장치의 주소를 한 필드에 포함하고 선택 프레임(SEL)을 만들어 전송
      
      <img width="338" alt="image" src="https://github.com/rlaisqls/TIL/assets/81006587/97e2e2c5-5f19-44b7-992b-81035b9a93e0">
  
- **토큰 전달**
  - 토큰을 가진 지국이 데이터 송신할 권한을 가짐
  - 토큰 전달 접근 방법에서의 논리적 링과 물리적 형상

## 채널화 방식

링크의 가용 대역폭을 지국들 사이에서 시간적으로, 주파수상으로, 또는 코딩을 통해 나누어서 다중 접근할 수 있도록 채널화한다.

- **주파수 분할 다중 접근(FDMA, frequency division multiple access)**
  - 사용 사능한 대역폭은 모든 지국들에 의해 공유
  - 각 지국들은 할당된 대역을 사용하여 데이터를 전송
  - 각각의 대역은 특정 지국을 위해 예약되어 있음
- **시간 분할 다중 접근(TDMA, time-division multiple access)**
  - 지국들이 시간상에서 채널을 공유
  - 각 지국은 자신이 데이터를 전송할 수 있는 타임 슬롯을 할당 받음
  - 각 지국은 할당받은 타임 슬롯에 자신의 데이터를 전송
- **코드 분할 다중 접근(CDMA, code-division multiple access)**
  - 링크이 전체 대역폭을 하나의 채널에서 점유
  - 모든 지국들은 시분할 없이 동시에 데이터를 송신 가능

---
참고
- [데이터통신과 네트워킹 TCP/IP 프로토콜 기반](https://product.kyobobook.co.kr/detail/S000001693780)